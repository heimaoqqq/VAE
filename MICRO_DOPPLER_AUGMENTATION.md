# 微多普勒时频图数据增广策略

## 🎯 项目目标

本项目的**核心目标**是通过**生成式AI模型**实现微多普勒时频图的数据增广，而不是传统的数据增强技术。

## 📋 什么是数据增广 vs 数据增强

### 数据增强 (Data Augmentation) ❌
传统的数据增强技术，如：
- 随机旋转、翻转、裁剪
- 颜色调整、亮度变化
- 噪声添加、模糊处理

**对微多普勒时频图的问题**：
- ❌ **破坏物理意义**: 时间轴和频率轴有明确的物理含义
- ❌ **扭曲时频关系**: 几何变换会破坏多普勒频移的时间演化
- ❌ **改变特征**: 颜色代表频率强度，随意调整会改变步态特征
- ❌ **引入伪影**: 可能产生不符合物理规律的时频模式

### 数据增广 (Data Augmentation via Generation) ✅
通过生成式模型创建新的、真实的数据样本：
- ✅ **保持物理一致性**: 生成符合雷达物理原理的时频图
- ✅ **学习真实分布**: 从真实数据中学习步态的时频特征
- ✅ **条件生成**: 可以指定生成特定用户的步态特征
- ✅ **无限扩展**: 理论上可以生成任意数量的新样本

## 🏗️ 本项目的数据增广方案

### 第一阶段: VAE学习表示
```
真实微多普勒图像 → VAE编码器 → 潜在表示 → VAE解码器 → 重建图像
```
- **目标**: 学习微多普勒时频图的紧凑表示
- **验证**: 重建图像应保持时频特征的完整性

### 第二阶段: 条件扩散生成
```
用户ID条件 + 随机噪声 → 扩散模型 → 潜在表示 → VAE解码器 → 新的微多普勒图像
```
- **目标**: 根据用户ID生成该用户的新步态样本
- **优势**: 生成的图像具有真实的物理特征

## 🔬 微多普勒时频图的特殊性

### 物理约束
1. **时间轴**: 代表步态周期的时间演化
2. **频率轴**: 代表多普勒频移 (与速度相关)
3. **强度**: 代表雷达回波强度 (与RCS相关)
4. **模式**: 反映人体各部位的运动特征

### 用户特异性
- **步频**: 不同用户的步行频率不同
- **步幅**: 影响多普勒频移的幅度
- **体型**: 影响雷达截面积和回波强度
- **步态**: 个人的行走习惯和生物力学特征

## ⚙️ 项目中的"增强"设置

### 当前实现
```python
# 数据加载器中的 augment 参数
dataset = MicroDopplerDataset(
    data_dir=data_dir,
    augment=True  # 这里的增强是什么？
)
```

### 实际作用 (已优化)
我们的 `augment=True` 只包含**极其保守**的操作：

1. **测量噪声** (noise_factor=0.005):
   ```python
   # 模拟雷达系统的测量不确定性
   noise = torch.randn_like(tensor) * 0.005
   ```

2. **信号强度调整** (factor_range=0.05):
   ```python
   # 模拟不同距离或RCS的微小变化
   adjustment = random_factor * 0.05
   ```

### 为什么这样设计？
- ✅ **物理合理**: 模拟真实雷达系统的不确定性
- ✅ **幅度极小**: 不会破坏时频结构
- ✅ **可选择**: 可以通过 `augment=False` 完全关闭

## 🎯 真正的数据增广效果

### 训练完成后的能力
1. **用户特定生成**:
   ```python
   # 为用户5生成10张新的步态图像
   generate_images(user_id=5, num_images=10)
   ```

2. **数据集扩展**:
   ```python
   # 原始: 31用户 × 平均100张 = 3100张
   # 增广后: 31用户 × 1000张 = 31000张 (10倍扩展)
   ```

3. **特征保持**:
   - 生成的图像保持用户的步态特征
   - 时频结构符合物理规律
   - 可用于训练下游分类模型

### 应用场景
- **步态识别**: 扩充训练数据，提高识别精度
- **异常检测**: 生成正常步态样本作为基准
- **跨域适应**: 生成不同条件下的步态数据
- **隐私保护**: 生成合成数据替代真实数据

## 🔧 使用建议

### 推荐设置
```python
# 训练时 - 使用极小的增强
dataset = MicroDopplerDataset(augment=True)

# 验证/测试时 - 不使用增强
dataset = MicroDopplerDataset(augment=False)

# 如果对数据质量要求极高 - 完全关闭
dataset = MicroDopplerDataset(augment=False)
```

### 质量验证
1. **视觉检查**: 确保增强后的图像仍然"看起来像"微多普勒图
2. **物理一致性**: 检查时频关系是否合理
3. **特征保持**: 确保用户特征没有被破坏

## 📊 效果评估

### 传统增强 vs 生成式增广

| 方法 | 数据量 | 质量 | 多样性 | 物理一致性 |
|------|--------|------|--------|------------|
| 传统增强 | 有限 | ❌ 可能降低 | ❌ 有限 | ❌ 可能破坏 |
| 生成式增广 | ✅ 无限 | ✅ 高质量 | ✅ 高多样性 | ✅ 保持一致 |

### 预期改进
- **分类精度**: 提升5-15%
- **泛化能力**: 更好的跨用户性能
- **鲁棒性**: 对噪声和变化更稳定

## 🎉 总结

本项目的**数据增广**是指：
1. ✅ **生成新的微多普勒时频图** (主要目标)
2. ✅ **保持物理和用户特征** (质量保证)
3. ✅ **大幅扩展数据集规模** (实用价值)
4. ⚠️ **极小的传统增强** (可选，非常保守)

这种方法比传统数据增强更适合微多普勒时频图，因为它能够生成真实、物理一致的新样本，而不是简单地变换现有数据。
